# :mailbox_with_mail: [등대지기] 부동산 안전거래를 위한 안심 상담 플랫폼 

SA : https://docs.google.com/spreadsheets/d/1JBQ1iAl9BINJq8oehd-nAWLhO557RTj0O0C3cUAFJQA/edit#gid=0

## :house_with_garden: 소개 | About Us 


<img width="960" alt="등대지기 오프닝 사진" src="https://user-images.githubusercontent.com/74133113/207536727-0c1afe94-a7ad-45e5-9b87-e4f953085424.png">

---

## :tada: 서비스 소개


### :question: 집을 구할 때 등기부등본하고...또 뭐 봐야한다고요?

#### :honey_pot: 발품 팔아 알아본 집이 마음에 들었을때!

#### :honey_pot: 대체 무엇을 따져봐야 할지 서툴기만 할 때!

#### :honey_pot: 덜컥 계약하기에는 조금 더 꼼꼼히 알아보고 싶을때!

#### :honey_pot: 공인중개사를 직접 찾아가기엔 질문이 가볍고 모호할 때!    

    

### :lock_with_ink_pen: 등기부등본과 건축물대장에 관련한 소소한 질문에 대해     

### :briefcase: 인증된 공인중개사의 답변을 들을 수 있는 상담서비스 플랫폼입니다.


### [등대지기 바로가기](https://www.lighthousefriend.com)     

---

## :calendar: 전체 프로젝트 개발기간 | Project Period   

:pushpin: 2022. 11.04 ~ 2022. 12.15    

---

## :nut_and_bolt: 아키텍쳐

![아키텍쳐](https://user-images.githubusercontent.com/74133113/207537598-b1cbcaa4-0fc3-4950-a62a-dc1c90836c28.png)    

---
## :earth_asia: 기술정보
![React](https://img.shields.io/badge/react-67DCF7?style=for-the-badge&logo=react&logoColor=white)
![JavaScript](https://img.shields.io/badge/javascript-F7DF1E?style=for-the-badge&logo=javascript&logoColor=white)
![Axios](https://img.shields.io/badge/axios-5A29E4?style=for-the-badge&logo=axios&logoColor=white)
![CreateReactApp](https://img.shields.io/badge/createreactapp-09D3AC?style=for-the-badge&logo=createreactapp&logoColor=white)
![ReactRouter](https://img.shields.io/badge/reactrouter-CA4245?style=for-the-badge&logo=reactrouter&logoColor=white)
![YARN](https://img.shields.io/badge/yarn-2C8EBB?style=for-the-badge&logo=yarn&logoColor=white)
![ReactQuery](https://img.shields.io/badge/react_query-FF4154?style=for-the-badge&logo=reactquery&logoColor=white)
![Recoil](https://img.shields.io/badge/recoil-0F8CC6?style=for-the-badge&logo=data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI2MDAiIGhlaWdodD0iNjAwIiB2aWV3Qm94PSIwIDAgNjAwIDYwMCI+PGxpbmsgeG1sbnM9IiIgdHlwZT0idGV4dC9jc3MiIGlkPSJkYXJrLW1vZGUiIHJlbD0ic3R5bGVzaGVldCIgaHJlZj0iIi8+PGcgZmlsbD0id2hpdGUiPjxwYXRoIGQ9Ik0xNDIuNTM2IDE5OC44NThjMCAyNi4zNi0yMS4zNjggNDcuNzItNDcuNzIgNDcuNzItMjYuMzYgMC00Ny43MjItMjEuMzYtNDcuNzIyLTQ3LjcyczIxLjM2LTQ3LjcyIDQ3LjcyLTQ3LjcyYzI2LjM1NSAwIDQ3LjcyMiAyMS4zNiA0Ny43MjIgNDcuNzIiLz48cGF0aCBkPSJNNTA1LjE4IDQxNC4yMjVIMjM4LjEyNGMtMzUuMjUgMC02My45MjYtMjguNjc0LTYzLjkyNi02My45MjNzMjguNjc4LTYzLjkyNiA2My45MjYtNjMuOTI2aDEyMC43OGMyMC44MTYgMCAzNy43NTMtMTYuOTM4IDM3Ljc1My0zNy43NTZzLTE2LjkzOC0zNy43NTYtMzcuNzUzLTM3Ljc1Nkg5NC44MWMtNy4yMjcgMC0xMy4wODYtNS44Ni0xMy4wODYtMTMuMDg1IDAtNy4yMjcgNS44Ni0xMy4wODYgMTMuMDg1LTEzLjA4NmgyNjQuMDkzYzM1LjI1IDAgNjMuOTIzIDI4LjY3OCA2My45MjMgNjMuOTI2cy0yOC42NzQgNjMuOTIzLTYzLjkyMyA2My45MjNoLTEyMC43OGMtMjAuODIgMC0zNy43NTYgMTYuOTM4LTM3Ljc1NiAzNy43NiAwIDIwLjgxNiAxNi45MzggMzcuNzUzIDM3Ljc1NiAzNy43NTNINTA1LjE4YzcuMjI3IDAgMTMuMDg2IDUuODYgMTMuMDg2IDEzLjA4NSAwIDcuMjI2LTUuODU4IDEzLjA4NS0xMy4wODUgMTMuMDg1eiIvPjxwYXRoIGQ9Ik00NTcuNDY0IDQwMS4xNDJjMC0yNi4zNiAyMS4zNi00Ny43MiA0Ny43Mi00Ny43MnM0Ny43MiAyMS4zNiA0Ny43MiA0Ny43Mi0yMS4zNiA0Ny43Mi00Ny43MiA0Ny43Mi00Ny43Mi0yMS4zNi00Ny43Mi00Ny43MiIvPjwvZz48c3R5bGUgeG1sbnM9IiIgaWQ9ImRhcmstbW9kZS1jdXN0b20tY29sb3IiPgoJCTpyb290ewoJCQktLWJnLWNvbG9yOnJnYmEoMjYsMjYsMjYsMSk7CgkJCS0tdGV4dC1jb2xvcjpyZ2JhKDExMCwxMTAsMTEwLDEpOwoJCQktLWEtY29sb3I6cmdiYSg5MCwxMjAsMTIwLDEpOwoJCQktLWEtdmlzaXRlZC1jb2xvcjpyZ2JhKDEyMCwxMjAsOTAsMSk7CgkJCS0tYS1ob3Zlci1jb2xvcjpyZ2JhKDIxMSwyMTEsMjExLDEpOwoJCQktLWlucHV0LWJvcmRlci1jb2xvcjpyZ2JhKDIxMSwyMTEsMjExLDAuMik7CgkJCS0taW5wdXQtcGxhY2Vob2xkZXItY29sb3I6cmdiYSgxNzMsMjE2LDIzMCwxKTsKCQkJLS1kaWFsb2ctYmctY29sb3I6cmdiYSgzNiwzNiwzNiwwLjk1KTsKCQkJLS1iZy1pbWFnZTpsaW5lYXItZ3JhZGllbnQocmdiYSgyNiwyNiwyNiwxKSxyZ2JhKDI2LDI2LDI2LDEpKTsKCQl9Cgk8L3N0eWxlPjwvc3ZnPg==)
![StyledComponent](https://img.shields.io/badge/styledcomponent-DB7093?style=for-the-badge&logo=styledcomponent&logoColor=white)
![TOAST.UI](https://img.shields.io/badge/TOAST.UI-5066DD?style=for-the-badge&logo=toast.ui&logoColor=white)
![AmazonCloudFront](https://img.shields.io/badge/AmazonCloudFront-DF5146?style=for-the-badge&logo=amazoncloudfront&logoColor=white)
![Route53](https://img.shields.io/badge/Route53-F58340?style=for-the-badge&logo=route53&logoColor=white)
![SpringBoot](https://img.shields.io/badge/springboot-6DB33F?style=for-the-badge&logo=springboot&logoColor=white) 
![AmazonRDS](https://img.shields.io/badge/amazonRDS-527FFF?style=for-the-badge&logo=amazonrds&logoColor=white)
![MySQL](https://img.shields.io/badge/MySQL-4479A1?style=for-the-badge&logo=mysql&logoColor=white)
![AmazonEC2](https://img.shields.io/badge/amazonEC2-FF9900?style=for-the-badge&logo=amazonec2&logoColor=white)
![amazonS3](https://img.shields.io/badge/amazonS3-569A31?style=for-the-badge&logo=amazons3&logoColor=white)
![AWSLambda](https://img.shields.io/badge/AWSLambda-FF9900?style=for-the-badge&logo=awslambda&logoColor=white)
![LoadBalancer](https://img.shields.io/badge/LoadBalancer-F48340?style=for-the-badge&logo=loadbalancer&logoColor=white)
![ElasticBeanstalk](https://img.shields.io/badge/ElasticBeanstalk-924F29?style=for-the-badge&logo=elasticbeanstalk&logoColor=white)
![GitHubActions](https://img.shields.io/badge/githubactions-2088FF?style=for-the-badge&logo=githubactions&logoColor=white)
![Figma](https://img.shields.io/badge/figma-F24E1E?style=for-the-badge&logo=figma&logoColor=white)


---

## :wrench: 기술적 의사결정

|사용기술|기술설명|
|----|----|
|CloudFront|사용자에게 제공되는 정적 컨텐츠의 전송 속도를 높이고 HTTPS를 적용시키기 위해 사용되었다.|
|Tanstack-query|캐싱, 에러 핸들링(예외 처리), 코드 길이 단축 및 가독성 등의 편의성과 효율적인 비동기 처리를 위해 사용하였다.|
|Recoil|비교적 가벼운 데이터를 전역적으로 관리하기 위하여 러닝커브가 낮고, 코드길이를 단축할 수있어서 사용하였다. |
|카카오 지도/주소 API|매물 상담과 발품 기록의 주소를 단순 텍스트로 기입하는 것이 아닌, API를 활용하여 정확한 주소와 지도상의 위치를 표기하기 위해 사용하였다.|
|@toast-ui/react-editor|사용자가 이미지와 텍스트를 원하는데로 편집하여 게시글을 구성할 수 있도록 사용하였다.메뉴한글지원 유무, 이미지 지원 유무, XSS 보안취약점 강화 등의 사항을 고려하여 결정하였다.|
|Swiper|이미지 활용이 많은 프로젝트의 특성상 UI/UX 개선과 성능 향상을 위해 사용하였다.|
|Amazon RDS|db에 저장하는 데이터들을 정형화하고 테이블 간 관계를 중점적으로 보기 위해 사용했다.|
|elastic beanstalk|elastic beanstalk을 사용하면 각 인프라에 대해 자세히 알지 못해도 AWS 클라우드에서 애플리케이션을 신속하게 배포하고 관리할 수 있다. 우리 서비스 같은 경우 RDS(mysql), Elasticache(redis), load balancer, auto scaling, cloud watch, lambda 등 aws의 여러 서비스를 사용해서 아키텍처를 구성할 예정이다. 각 서비스별 복잡한 설정 과정을 건너뛰고 손쉽게 연동하고 서버를 배포할 수 있기 때문에 사용하기로 결정했다|
|load balancer, Auto Scaling|Auto Scaling을 사용하면 트래픽이 과도하게 많아질 때 서버를 자동으로 증설해준다. 병목 지점에 도달했을 때 ELB를 사용하면 접근을 여러 대의 EC2 인스턴스로 분산할 수 있다. 인스턴스를 분산함으로써 부하를 분산할 수 있다.  또한 1대의 인스턴스에 에러가 발생해도 다른 인스턴스에서 트래픽을 처리할 수 있기 때문에 가용성이 보장되고 예기치 않은 트래픽 증가에 대비하기 위해서 적용하게 되었다.|
|queryDsl|HQL(Hibernate Query Language) 쿼리를 타입에 안전한 방식으로 실행하기 위해 사용한다. HQL 쿼리를 작성하다보면 String 연결을 이용하게 되고, 결과적으로 읽기 어려운 코드를 만든다. String을 이용해서 도메인 타입과 프로퍼티를 참조하다 보면 오타 등으로 잘못된 참조를 할 수 있다. 도메인 변경이 직접적으로 쿼리에 반영되고 쿼리 작성과정에서 코드 자동완성을 사용함으로써 더 빠르고 안전하게 만들 수 있기 때문에 사용하기로 결정했다.|
|lambda|• 이미지 리사이징 목적 : 우리 서비스 같은 경우에 각 매물당 최대 30장의 이미지가 들어갈 수 있다. 원본 크기의 이미지를 그대로 불러오게 되면 고화질 이미지일수록 이미지 처리 속도가 길어지게 된다. 또한 이미지 생성과 삭제가 많아질수록 이미지 작업에 따른 비용도 늘어난다. 고화질 사진을 썸네일에 그대로 사용할 경우 화질이 깨지는 현상이 발생한다. 따라서 사용자가 S3에 업로드한 사진을 썸네일 크기에 맞춰 리사이징하면 화질이 깨지는 현상이 해결되고, 이미지 작업에 따른 비용이 감소된다.|
|github action|짧은 개발 기간상 템플릿이 많고 환경 구축이 쉬운 시스템을 사용하는 게 맞다고 생각했다. 일반적으로 많이 사용되는 CI/CD 서비스인 Jenkins와 github action을 두고 봤을때, github action은 별도의 서버 설치가 필요 없고 github 마켓 플레이스를 통해 workflow 정보를 쉽게 확인할 수 있으므로 비교적 Jenkins에 비해 처음 CI/CD를 구축하는 사람 입장에서 접근하고 환경 구축하기가 쉽다고 판단했다.|

---

## :crossed_swords: 주요 기능      
* 공인중개사와의 부동산 관련문서 해석 상담 요청 
* 상담 내용에 있는 주소 정보를 카카오맵 마커로 시각화
* 의뢰인의 상담 목록 조회 및 검색 기능
* 상담에 대한 만족도 표현 가능
* 공인중개사 프로필 수정 (닉네임, 프로필 사진, 소개메세지)
* 공인중개사가 상담했던 의뢰 목록을 마이페이지에서 무한스크롤로 조회 가능 
* 관리자 계정 별도 운영 / 인증 메일 발송

--------------------
예시주소입니다. 실제와 무관함을 알려드립니다. 

|1. 일반회원가입 및 동시로그인 |  2. 발품기록  |  3. 검색 및 목록조회  |
|--------------------|------------|-------------------|
|![일반회원가입 및 동시로그인](https://user-images.githubusercontent.com/74133113/207530793-a21dffb3-c839-4410-91da-ba00ece2ec72.gif)   |  ![발품기록](https://user-images.githubusercontent.com/74133113/207530972-14f27e04-029c-4f53-9ae6-4c63308764fb.gif) | ![검색및목록조회](https://user-images.githubusercontent.com/74133113/207531803-10b3676a-12e5-4f1b-85dc-ee4aeca7471a.gif) |
|4. 상담신청  | 5. 캐로셀 및 목록 조회 | 6. 마커 클릭시 상세페이지 모달|
|![상담신청](https://user-images.githubusercontent.com/74133113/207531011-8109109c-2501-4791-aa39-2c0c652ef831.gif)| ![캐로셀및목록조회](https://user-images.githubusercontent.com/74133113/207531355-2633f684-06c0-42c6-9bcd-3b992f12eab7.gif) | ![마커클릭시 상세페이지 모달](https://user-images.githubusercontent.com/74133113/207531387-d37334a3-43df-43b7-a6b1-c1a53351012d.gif)|
|7. 공인중개사 회원가입 | 8. 인증되지 않은 접근 | 9. 관리자계정 승인과정|
|![공인중개사회원가입](https://user-images.githubusercontent.com/74133113/207531423-30ad96ae-cd1f-4989-998e-93d88f4f10ee.gif)| ![인증되지 않은접근](https://user-images.githubusercontent.com/74133113/207531448-1eb9baa9-06f2-40c5-9019-654160dcb6d5.gif)|![관리자계정승인과정](https://user-images.githubusercontent.com/74133113/207531477-b3362c52-9b98-44e8-a3d2-e02ec2e90ca2.gif)|
|10. 거부된 아이디 접근|11. 공인중개사 답변달기|12. 일반회원 답변확인
|![거부된 아이디 접근](https://user-images.githubusercontent.com/74133113/207531513-b0b085bc-993a-4d77-846c-fd01f7020eb6.gif)|![공인중개사답변달기](https://user-images.githubusercontent.com/74133113/207531587-ac88c25a-ffc8-4985-8a1a-f13d5260bfa5.gif)|![일반회원답변확인](https://user-images.githubusercontent.com/74133113/207531603-52eb94c4-909b-4ecd-bb61-21537889ff4c.gif)|


|13. 승인 메일 안내 |
|------|
|![승인메일안내](https://user-images.githubusercontent.com/74133113/207531543-fb2d7c22-eef1-408c-9a68-fc73c9dbbf14.gif)|

----------------------

## :sparkler: 트러블슈팅  
<details>
    <summary> :heavy_check_mark: 프론트단에서 이미지 압축하여 서버로 전송 </summary>    
       
 **`문제상황`**  
    1. 백엔드에서 이미지 리사이징 기능구현이 준비되지 않은 상황     
    2. 이미지를 30장씩 주고 받아야 하는 상황에서 딜레이로 인한 사용자의 불편사항 발생 우려      
    3. 사용자가 과도한 크기의 이미지파일을 전송할 상황 방지      

**`의견 조율`**    
    1. 프로트엔드 인원 3명이 모두 사용하여야하기 때문에 로직이 간단한 라이브러리 적용     
    2. 이미지가 깨지거나, 잘리는 등의 상황을 최대한 방지       
    
**`의견 결정`**    
    1. browser-image-compression 이라는 라이브러리를 사용하기로 결정     
    2. 압축 후 반환되는 blob 파일을 이미지 깨짐이나, 짤림을 방지하기 위해 안전한 문자로(Base64)로 바꿔서 서버로 보내기로 결정     
    
**`개선 결과`**  
1.  개선 전     
    - 사용자가 휴대폰의 사진을 업로드한다고 가정하고 테스트했을때 대략 70MB ~ 80MB의 사진을 백엔드로 보내게 된다.        
    - 이때 Request 지연시간만 6s ~ 8s 가량이 걸리는 것으로 확인되었고, Response 지연시간은 15s ~ 25s 정도로 확인되었다.     
    ![timebefore](https://user-images.githubusercontent.com/74133113/207632940-c8b2ca32-50b7-4315-b59d-7ce57cb581ae.jpeg)

2.  개선 후    
    - 파일 압축 적용 후 파일용량은 2.5MB ~ 3MB 정도로 압축되었다.     
    - Request 지연시간은 200ms ~ 500ms 로 대폭 감소하였고, Response 지연시간도 2s ~ 3s로 줄어들었다.   
    ![timeafter](https://user-images.githubusercontent.com/74133113/207632974-3058d570-ba85-4cd6-ad7f-c846f933fd33.jpeg)    
    
**`남은과제`**    
    30장을 한꺼번에 보내다보니 여전히 지연시간이 긴 편이라서, 첨부와 동시에 미리 한장씩 서버로 보내고 응답을 받아 미리보기를 구현하면 훨씬 빠르게 될 것 같다.  
    
    
    

</details>

<details>
    <summary>:heavy_check_mark: 리사이징으로 썸네일 이미지 생성</summary>     
              
    
**`요구사항`**    
    한번의 Request를 통해 최대 30장 이상의 S3에 요금 부담 절충안 필요    
    
**`선택지`**    
    1안) 여러 API로 분할하여 ~~유저가~~ 필요시에만 해당 URL을 통해 이미지를 업로드 할 수 있게 함    
    2안) 클라이언트에서 이미지를 압축해서 전달해주기 + S3에 이미지가 업로드 될때마다 serverless 프레임 워크를 사용해 S3요금 절감함     
    
**`의견 조율`**    
    프로젝트의 특성상 많은 이미지 데이터를 주고 받아야함과 동시에 많은 요금이 부가될 것을 전망하여 AWS lambda를 도입해 serverless 프레임 워크를 사용하기로 함     
    
**`의견 결정`**    
    AWS Lambda를 사용하여 S3 bucket을 분리하였음, 리사이징된 썸네일 사진과 원본을 따로 저장하고 Lambda에 cloud watch를 통해 이미지 데이터의 송수신을 수시로 모니터링하기로 함     
    
</details>   

<details>
    <summary>:heavy_check_mark: 이메일 Sender 로딩 성능 개선 </summary>    

**`요구사항`**   
    공인중개사 회원 가입 승인시 java email sender api로 이메일을 보낼 때 대기 시간이 김     

**`선택지`**    
    1안)  동보 발송 형태 (connection을 개발자가 직접 연 뒤에 보낼 내용을 한번에 전송하는 방식)     
    2안)  비동기 실행     

**`의견 조율`**     
    속도 측면에서 ‘동보 발송’ 형태는 성능 개선의 부분에 있어 좋지만 대상자가 많아 질 수록 스팸처리 되는 부분인 단점이 있을 뿐더러 현 프로젝트에 있어서 다른 내용을 각각의 인원에게 보내야 하는 경우가 아니라고 판단해 1안 보다 2안을 채택하기로 함     
  
**`의견 결정`**    
     멀티 쓰레드로 비동기 환경을 구성해 이메일 전송하는 로직과 사용자에게 응답을 보내는 로직을 비동기 실행   

**`결과`**    
    12.22s가량 소요되었던 응답시간을 12ms로 감소시킴    

    
</details>    
     
     
     
<details>
    <summary>:heavy_check_mark: Query문 검색 기능 성능 개선 중</summary>    
           
**`요구사항`**    
    유저가 최근에 검색했던 검색어 및 자동완성 기능 요구      
    
**`선택지`**    
    1안)  새로운 Entity를 생성해 DB에 검색했었던 keyword를 저장하고 자동으로 불러오기     
    2안)  Querydsl 과 fulltext search로 개선       
    
**`의견 조율`**    
    배포되어있는 검색 기능 부분에서 속도 개선 위주로 생각해 JPA를 사용했었지만 동적 SQL을 사용해 다양한 기능을 사용해 유저의 서비스 개선 고려       
    
**`의견 결정`**    
    현재 JPA Query DSL을 환경설정 후 동적 SQL을 사용하여 유저의 서비스를 위한 다양한 시도 중
    
</details>


----

## :flamingo: 팀원 소개

|조병민|김성욱|김하나|장경원|조정우|정규재|손하영|
|----|----|----|----|----|----|----|
|FE(팀장)|FE|FE|BE(부팀장)|BE|BE|Designer|
|[:link:](https://github.com/merrybmc)|[:link:](https://github.com/ksu930)|[:link:](https://github.com/superrookie8)|[:link:](https://github.com/Whylano)|[:link:](https://github.com/jjw0611)|[:link:](https://github.com/kyujae-Jung)||
